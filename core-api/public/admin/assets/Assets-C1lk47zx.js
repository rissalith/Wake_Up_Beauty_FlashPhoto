import{r as e,x as a,a as l,i as s,c as t,o as n,d as o,e as i,w as c,f as u,E as d,I as r,G as v,h as p,j as m,t as f,a0 as g,X as y,a1 as b,O as k,P as h,H as _,J as w,a2 as N,a9 as C,l as V}from"./index-CsAM56ZN.js";import{d as I}from"./vuedraggable.umd-CxnRjWCw.js";import{_ as U,c as x}from"./_plugin-vue_export-helper-Coss9NIm.js";const z={class:"assets-management"},A={class:"asset-section"},L={class:"section-header"},P={class:"banner-list"},B={class:"banner-item"},G={class:"banner-order"},D={class:"banner-actions"},R={class:"upload-placeholder"},E={class:"upload-placeholder"},$={class:"asset-section"},j={class:"section-header"},T={class:"feature-list"},O={class:"feature-label"},S={class:"feature-upload-area"},J={key:1,class:"upload-placeholder small"},K={class:"asset-section"},W={class:"section-header"},H={class:"feature-list"},M={class:"feature-label"},X={class:"feature-upload-area"},q={key:1,class:"upload-placeholder small"},F={class:"asset-section"},Q={class:"tabbar-list"},Y={class:"tabbar-name"},Z={class:"tabbar-icons"},ee={class:"tabbar-icon-item"},ae={key:1,class:"icon-placeholder"},le={class:"tabbar-icon-item"},se={key:1,class:"icon-placeholder"},te={class:"asset-section"},ne={class:"scene-upload-area"},oe={class:"upload-placeholder"},ie={class:"upload-placeholder"},ce={class:"scene-assets-grid"},ue=["onClick"],de={class:"scene-asset-preview"},re={class:"scene-asset-info"},ve=["title"],pe={class:"scene-asset-actions"},me={key:0,class:"empty-tip"},fe={class:"asset-section"},ge={class:"section-header"},ye={class:"section-actions"},be={class:"ui-icons-grid"},ke=["onClick"],he={class:"ui-icon-preview"},_e=["src","alt"],we={class:"ui-icon-name"},Ne={class:"upload-placeholder small"},Ce={class:"asset-section"},Ve={class:"logo-section"},Ie={class:"logo-list"},Ue={class:"logo-label"},xe={class:"logo-upload-area"},ze={key:1,class:"upload-placeholder small"},Ae={class:"about-section"},Le={class:"about-images-grid"},Pe={class:"upload-placeholder"},Be={class:"upload-placeholder"},Ge=["src","alt"],De={class:"asset-info"},Re={class:"asset-name"},Ee={class:"asset-overlay"},$e={class:"asset-section"},je={class:"scene-assets-grid"},Te={class:"upload-placeholder"},Oe={class:"upload-placeholder"},Se={class:"generating-animation"},Je={class:"asset-info"},Ke=["onClick"],We=["src","alt"],He={class:"asset-info"},Me={class:"asset-name"},Xe={class:"asset-overlay"},qe={key:0,class:"empty-tip"},Fe={class:"dialog-footer"},Qe={key:0,class:"asset-detail"},Ye="/api/assets/upload",Ze=U({__name:"Assets",setup(U){const Ze=e(!1),ea=e("banner"),aa=a(()=>({Authorization:`Bearer ${localStorage.getItem("admin_token")}`})),la=[{label:"简体中文",value:"zh-CN"},{label:"English",value:"en"}],sa=e("zh-CN"),ta=e([]),na=l({"zh-CN":"",en:""}),oa=l({"zh-CN":"",en:""}),ia=e([{name:"home",label:"首页",normal:"",active:""},{name:"creator",label:"创作",normal:"",active:""},{name:"history",label:"历史",normal:"",active:""},{name:"mine",label:"我的",normal:"",active:""}]),ca=e([]),ua=e(""),da=e(!1),ra=e([]),va=e(!1),pa=e([]),ma=[{key:"logo-main",label:"主Logo"},{key:"logo-white",label:"白色Logo"},{key:"logo-icon",label:"图标Logo"},{key:"logo-text",label:"文字Logo"}],fa=l({"logo-main":"","logo-white":"","logo-icon":"","logo-text":""}),ga=e([]),ya=e(!1),ba=e(""),ka=e(""),ha=e("ai-generated"),_a=e(""),wa=e(!1);e(!1);const Na=e([]);let Ca=0;const Va=e(!1),Ia=e(null),Ua=a(()=>{if(!ua.value)return ca.value;const e=ua.value.toLowerCase();return ca.value.filter(a=>a.fileName.toLowerCase().includes(e))});async function xa(){var e;Ze.value=!0;try{const a=await x.get("/assets/list");if(200===a.code||0===a.code){const l=a.data||{};ta.value=(null==(e=l.banners)?void 0:e[sa.value])||[],l.features&&Object.keys(l.features).forEach(e=>{na[e]=l.features[e]?l.features[e]+"?t="+Date.now():""}),l.titles&&Object.keys(l.titles).forEach(e=>{oa[e]=l.titles[e]?l.titles[e]+"?t="+Date.now():""}),l.tabbar&&ia.value.forEach(e=>{var a,s;e.normal=(null==(a=l.tabbar[e.name])?void 0:a.normal)?l.tabbar[e.name].normal+"?t="+Date.now():"",e.active=(null==(s=l.tabbar[e.name])?void 0:s.active)?l.tabbar[e.name].active+"?t="+Date.now():""}),ca.value=l.uiIcons||[],ra.value=l.sceneIcons||[],pa.value=l.generalAssets||[],l.logos&&Object.keys(l.logos).forEach(e=>{fa[e]=l.logos[e]?l.logos[e]+"?t="+Date.now():""}),ga.value=l.aboutImages||[]}}catch(a){console.error("加载素材失败:",a),d.error("加载素材列表失败")}finally{Ze.value=!1}}async function za(){Ze.value=!0;try{const e=await x.get("/assets/banners",{params:{lang:sa.value}});200!==e.code&&0!==e.code||(ta.value=e.data||[])}catch(e){console.error("加载Banner失败:",e)}finally{Ze.value=!1}}function Aa(e){const a=e.type.startsWith("image/"),l=e.size/1024/1024<2;return a?!!l||(d.error("图片大小不能超过 2MB!"),!1):(d.error("只能上传图片文件!"),!1)}function La(e){const a="image/svg+xml"===e.type||"image/png"===e.type,l=e.size/1024<500;return a?!!l||(d.error("图标大小不能超过 500KB!"),!1):(d.error("只能上传 SVG 或 PNG 文件!"),!1)}function Pa(e){var a;200!==e.code&&0!==e.code||!(null==(a=e.data)?void 0:a.url)?d.error(e.message||"上传失败"):(ta.value.push({key:e.data.key,url:e.data.url,fileName:e.data.fileName}),d.success("Banner上传成功"))}async function Ba(){try{const e=ta.value.map(e=>e.key);await x.post("/assets/banners/sort",{lang:sa.value,keys:e}),d.success("排序已更新")}catch(e){d.error("排序更新失败")}}function Ga(e,a,l){var s;if(200!==e.code&&0!==e.code||!(null==(s=e.data)?void 0:s.url))d.error(e.message||"上传失败");else{const s=ia.value.find(e=>e.name===a);s&&(s[l]=e.data.url+"?t="+Date.now()),d.success("上传成功")}}function Da(e){var a;200!==e.code&&0!==e.code||!(null==(a=e.data)?void 0:a.url)?d.error(e.message||"上传失败"):(ca.value.push({key:e.data.key,url:e.data.url,fileName:e.data.fileName}),d.success("上传成功"))}function Ra(e){var a;200!==e.code&&0!==e.code||!(null==(a=e.data)?void 0:a.url)?d.error(e.message||"上传失败"):(pa.value.push({key:e.data.key,url:e.data.url,fileName:e.data.fileName}),d.success("上传成功"))}function Ea(e){var a;200!==e.code&&0!==e.code||!(null==(a=e.data)?void 0:a.url)?d.error(e.message||"上传失败"):(ga.value.push({key:e.data.key,url:e.data.url,fileName:e.data.fileName}),d.success("上传成功"))}const $a={banner:"生成一张APP首页轮播图，展示AI照片生成功能，现代简约风格，渐变色背景，包含人物剪影和科技元素，尺寸750×400像素，高清画质",feature:"生成一张特色功能展示图，展示AI智能修图功能，扁平化设计风格，明亮的配色，包含相机和魔法棒图标元素，高清画质",title:'生成一个APP导航栏标题图片，文字"醒美闪图"，艺术字体设计，渐变金色效果，透明背景，高清PNG格式',"scene-icon":"生成一个场景图标，圆角方形设计，扁平化风格，明亮的配色，简洁的图形元素，512×512像素，高清画质",logo:'生成一个APP Logo图片，"醒美闪图"品牌标识，现代简约设计，渐变金色或橙色，透明背景，高清PNG格式',general:"生成一张高质量素材图片，写实风格，4K画质，背景简洁，主体突出"},ja=e("general");function Ta(e="general",a="ai-generated"){ja.value=e,ba.value=$a[e]||$a.general,ka.value="",ha.value=a,_a.value="",ya.value=!0}async function Oa(){var e;if(!ba.value.trim())return void d.warning("请输入图片描述");const a=++Ca,l={id:a,name:ka.value||"生成中...",prompt:ba.value,folder:ha.value};Na.value.unshift(l),ya.value=!1,d.info("已开始后台生成，完成后会自动添加到列表");try{const a=await x.post("/assets/ai-generate",{prompt:l.prompt},{timeout:15e4});if(0===a.code&&(null==(e=a.data)?void 0:e.imageBase64)){const e=await x.post("/assets/ai-save",{imageBase64:a.data.imageBase64,prompt:l.prompt,name:l.name,folder:l.folder});0===e.code&&(pa.value.unshift({key:e.data.key,url:e.data.url,fileName:e.data.fileName,displayName:l.name||e.data.fileName,source:"ai-generated",prompt:l.prompt}),d.success(`图片"${l.name||"未命名"}"生成完成`))}else d.error(`图片生成失败: ${a.message||"未知错误"}`)}catch(s){d.error(`图片生成失败: ${s.message}`)}finally{const e=Na.value.findIndex(e=>e.id===a);e>-1&&Na.value.splice(e,1)}}async function Sa(){if(Ia.value)try{await x.put(`/assets/metadata/${encodeURIComponent(Ia.value.key)}`,{name:Ia.value.displayName}),d.success("名称已更新");const e=pa.value.find(e=>e.key===Ia.value.key);e&&(e.displayName=Ia.value.displayName),Va.value=!1}catch(e){d.error("更新失败")}}async function Ja(){try{await V.confirm("这将上传100+个常用SVG图标到图标库，是否继续？","初始化图标库",{type:"info"}),da.value=!0;const e=await x.post("/assets/init-icons");200===e.code||0===e.code?(d.success(e.message),await xa()):d.error(e.message||"初始化失败")}catch(e){"cancel"!==e&&d.error("初始化失败: "+(e.message||e))}finally{da.value=!1}}function Ka(e){"banner"===e?za():"scene-assets"===e&&async function(){var e;va.value=!0;try{const a=await x.get("/assets/list");200!==a.code&&0!==a.code||(ra.value=(null==(e=a.data)?void 0:e.sceneIcons)||[])}catch(a){console.error("加载场景素材失败:",a)}finally{va.value=!1}}()}function Wa(e){var a;200!==e.code&&0!==e.code||!(null==(a=e.data)?void 0:a.url)?d.error(e.message||"上传失败"):(ra.value.push({key:e.data.key,url:e.data.url,fileName:e.data.fileName}),d.success("场景素材上传成功"))}function Ha(e){navigator.clipboard.writeText(e.url),d.success("已复制素材URL")}function Ma(e){navigator.clipboard.writeText(e),d.success("已复制URL")}function Xa(e){var a,l;if(e.displayName&&!e.displayName.includes("_"))return e.displayName;const s=null==(a=e.fileName)?void 0:a.match(/(\d{13})/);return s?s[1]:(null==(l=e.fileName)?void 0:l.replace(/\.[^.]+$/,""))||"未命名"}return s(()=>{xa()}),(e,a)=>{const l=u("el-radio-button"),s=u("el-radio-group"),U=u("el-image"),ca=u("el-icon"),_a=u("el-button"),Ca=u("el-upload"),xa=u("el-tab-pane"),$a=u("el-input"),ja=u("el-tag"),qa=u("el-tabs"),Fa=u("el-form-item"),Qa=u("el-option"),Ya=u("el-select"),Za=u("el-form"),el=u("el-dialog"),al=r("loading");return n(),t("div",z,[a[69]||(a[69]=o("div",{class:"page-header"},[o("div",{class:"header-left"},[o("h2",null,"素材管理"),o("span",{class:"subtitle"},"管理Banner、特色图、导航标题、TabBar、场景素材等UI素材")])],-1)),i(qa,{modelValue:ea.value,"onUpdate:modelValue":a[9]||(a[9]=e=>ea.value=e),type:"card",onTabChange:Ka},{default:c(()=>[i(xa,{label:"Banner轮播",name:"banner"},{default:c(()=>[o("div",A,[o("div",L,[a[23]||(a[23]=o("span",{class:"section-title"},"首页轮播图",-1)),i(s,{modelValue:sa.value,"onUpdate:modelValue":a[0]||(a[0]=e=>sa.value=e),size:"small",onChange:za},{default:c(()=>[i(l,{label:"zh-CN"},{default:c(()=>[...a[21]||(a[21]=[p("简体中文",-1)])]),_:1}),i(l,{label:"en"},{default:c(()=>[...a[22]||(a[22]=[p("English",-1)])]),_:1})]),_:1},8,["modelValue"])]),v((n(),t("div",P,[i(m(I),{modelValue:ta.value,"onUpdate:modelValue":a[1]||(a[1]=e=>ta.value=e),"item-key":"key",onEnd:Ba,class:"banner-grid"},{item:c(({element:e,index:a})=>[o("div",B,[o("div",G,f(a+1),1),i(U,{src:e.url,fit:"cover",class:"banner-img","preview-src-list":ta.value.map(e=>e.url)},null,8,["src","preview-src-list"]),o("div",D,[i(_a,{size:"small",type:"danger",onClick:l=>async function(e,a){try{await V.confirm("确定删除这张Banner吗？","删除确认",{type:"warning"}),await x.delete("/assets/delete",{data:{key:e.key}}),ta.value.splice(a,1),d.success("删除成功")}catch{}}(e,a)},{default:c(()=>[i(ca,null,{default:c(()=>[i(m(g))]),_:1})]),_:1},8,["onClick"])])])]),_:1},8,["modelValue"]),i(Ca,{class:"banner-upload",action:Ye,headers:aa.value,data:{category:"banner",lang:sa.value},"show-file-list":!1,"on-success":Pa,"before-upload":Aa,accept:"image/*"},{default:c(()=>[o("div",R,[i(ca,null,{default:c(()=>[i(m(y))]),_:1}),a[24]||(a[24]=o("span",null,"上传Banner",-1)),a[25]||(a[25]=o("p",null,"750×400px",-1))])]),_:1},8,["headers","data"]),o("div",{class:"banner-upload ai-generate-btn",onClick:a[2]||(a[2]=e=>Ta("banner","banner"))},[o("div",E,[i(ca,null,{default:c(()=>[i(m(b))]),_:1}),a[26]||(a[26]=o("span",null,"AI生成",-1)),a[27]||(a[27]=o("p",null,"生成轮播图",-1))])])])),[[al,Ze.value]])])]),_:1}),i(xa,{label:"特色功能图",name:"feature"},{default:c(()=>[o("div",$,[o("div",j,[a[29]||(a[29]=o("span",{class:"section-title"},"首页特色功能区图片",-1)),i(_a,{type:"warning",size:"small",onClick:a[3]||(a[3]=e=>Ta("feature","feature"))},{default:c(()=>[i(ca,null,{default:c(()=>[i(m(b))]),_:1}),a[28]||(a[28]=p(" AI生成 ",-1))]),_:1})]),o("div",T,[(n(),t(k,null,h(la,e=>o("div",{class:"feature-item",key:e.value},[o("div",O,f(e.label),1),o("div",S,[i(Ca,{class:"feature-uploader",action:Ye,headers:aa.value,data:{category:"feature",lang:e.value},"show-file-list":!1,"on-success":a=>function(e,a){var l;200!==e.code&&0!==e.code||!(null==(l=e.data)?void 0:l.url)?d.error(e.message||"上传失败"):(na[a]=e.data.url+"?t="+Date.now(),d.success("上传成功"))}(a,e.value),"before-upload":Aa,accept:"image/*"},{default:c(()=>[na[e.value]?(n(),_(U,{key:0,src:na[e.value],fit:"contain",class:"feature-preview"},null,8,["src"])):(n(),t("div",J,[i(ca,null,{default:c(()=>[i(m(y))]),_:1}),a[30]||(a[30]=o("span",null,"上传图片",-1))]))]),_:2},1032,["headers","data","on-success"])])])),64))])])]),_:1}),i(xa,{label:"导航标题",name:"title"},{default:c(()=>[o("div",K,[o("div",W,[a[32]||(a[32]=o("span",{class:"section-title"},"导航栏标题图片",-1)),i(_a,{type:"warning",size:"small",onClick:a[4]||(a[4]=e=>Ta("title","title"))},{default:c(()=>[i(ca,null,{default:c(()=>[i(m(b))]),_:1}),a[31]||(a[31]=p(" AI生成 ",-1))]),_:1})]),o("div",H,[(n(),t(k,null,h(la,e=>o("div",{class:"feature-item",key:e.value},[o("div",M,f(e.label),1),o("div",X,[i(Ca,{class:"title-uploader",action:Ye,headers:aa.value,data:{category:"title",lang:e.value},"show-file-list":!1,"on-success":a=>function(e,a){var l;200!==e.code&&0!==e.code||!(null==(l=e.data)?void 0:l.url)?d.error(e.message||"上传失败"):(oa[a]=e.data.url+"?t="+Date.now(),d.success("上传成功"))}(a,e.value),"before-upload":Aa,accept:"image/*"},{default:c(()=>[oa[e.value]?(n(),_(U,{key:0,src:oa[e.value],fit:"contain",class:"title-preview"},null,8,["src"])):(n(),t("div",q,[i(ca,null,{default:c(()=>[i(m(y))]),_:1}),a[33]||(a[33]=o("span",null,"上传图片",-1))]))]),_:2},1032,["headers","data","on-success"])])])),64))])])]),_:1}),i(xa,{label:"TabBar图标",name:"tabbar"},{default:c(()=>[o("div",F,[a[36]||(a[36]=o("div",{class:"section-header"},[o("span",{class:"section-title"},"底部导航栏图标")],-1)),o("div",Q,[(n(!0),t(k,null,h(ia.value,e=>(n(),t("div",{class:"tabbar-item",key:e.name},[o("div",Y,f(e.label),1),o("div",Z,[o("div",ee,[a[34]||(a[34]=o("span",{class:"icon-state"},"默认",-1)),i(Ca,{class:"tabbar-uploader",action:Ye,headers:aa.value,data:{category:"tabbar",name:e.name,state:"normal"},"show-file-list":!1,"on-success":a=>Ga(a,e.name,"normal"),"before-upload":Aa,accept:"image/*"},{default:c(()=>[e.normal?(n(),_(U,{key:0,src:e.normal,fit:"contain",class:"tabbar-icon-preview"},null,8,["src"])):(n(),t("div",ae,[i(ca,null,{default:c(()=>[i(m(y))]),_:1})]))]),_:2},1032,["headers","data","on-success"])]),o("div",le,[a[35]||(a[35]=o("span",{class:"icon-state"},"选中",-1)),i(Ca,{class:"tabbar-uploader",action:Ye,headers:aa.value,data:{category:"tabbar",name:e.name,state:"active"},"show-file-list":!1,"on-success":a=>Ga(a,e.name,"active"),"before-upload":Aa,accept:"image/*"},{default:c(()=>[e.active?(n(),_(U,{key:0,src:e.active,fit:"contain",class:"tabbar-icon-preview"},null,8,["src"])):(n(),t("div",se,[i(ca,null,{default:c(()=>[i(m(y))]),_:1})]))]),_:2},1032,["headers","data","on-success"])])])]))),128))])])]),_:1}),i(xa,{label:"场景素材",name:"scene-assets"},{default:c(()=>[o("div",te,[a[43]||(a[43]=o("div",{class:"section-header"},[o("span",{class:"section-title"},"场景配置素材"),o("span",{class:"section-tip"},"用于场景图标、步骤选项示意图等")],-1)),o("div",ne,[i(Ca,{class:"scene-asset-upload",action:Ye,headers:aa.value,data:{category:"scene-icon"},"show-file-list":!1,"on-success":Wa,"before-upload":Aa,accept:"image/*",multiple:""},{default:c(()=>[o("div",oe,[i(ca,null,{default:c(()=>[i(m(y))]),_:1}),a[37]||(a[37]=o("span",null,"上传素材",-1)),a[38]||(a[38]=o("p",null,"PNG/JPG/WebP",-1))])]),_:1},8,["headers"]),o("div",{class:"scene-asset-upload ai-generate-btn",onClick:a[5]||(a[5]=e=>Ta("scene-icon","scenes"))},[o("div",ie,[i(ca,null,{default:c(()=>[i(m(b))]),_:1}),a[39]||(a[39]=o("span",null,"AI生成",-1)),a[40]||(a[40]=o("p",null,"生成场景素材",-1))])])]),v((n(),t("div",ce,[(n(!0),t(k,null,h(ra.value,e=>(n(),t("div",{class:"scene-asset-item",key:e.key,onClick:a=>Ha(e)},[o("div",de,[i(U,{src:e.url,fit:"contain","preview-src-list":[e.url]},null,8,["src","preview-src-list"])]),o("div",re,[o("span",{class:"scene-asset-name",title:e.fileName},f(e.fileName),9,ve),o("div",pe,[i(_a,{size:"small",type:"primary",link:"",onClick:N(a=>Ha(e),["stop"])},{default:c(()=>[...a[41]||(a[41]=[p(" 复制URL ",-1)])]),_:1},8,["onClick"]),i(_a,{size:"small",type:"danger",link:"",onClick:N(a=>async function(e){try{await V.confirm(`确定删除素材 "${e.fileName}" 吗？`,"删除确认",{type:"warning"}),await x.delete("/assets/delete",{data:{key:e.key}});const a=ra.value.findIndex(a=>a.key===e.key);a>-1&&ra.value.splice(a,1),d.success("删除成功")}catch(a){"cancel"!==a&&d.error("删除失败: "+(a.message||a))}}(e),["stop"])},{default:c(()=>[...a[42]||(a[42]=[p(" 删除 ",-1)])]),_:1},8,["onClick"])])])],8,ue))),128)),0!==ra.value.length||va.value?w("",!0):(n(),t("div",me," 暂无场景素材，请上传图片 "))])),[[al,va.value]])])]),_:1}),i(xa,{label:"UI图标",name:"ui-icons"},{default:c(()=>[o("div",fe,[o("div",ge,[a[45]||(a[45]=o("span",{class:"section-title"},"通用UI图标 (SVG/PNG)",-1)),o("div",ye,[i(_a,{type:"primary",size:"small",onClick:Ja,loading:da.value},{default:c(()=>[...a[44]||(a[44]=[p(" 初始化图标库 ",-1)])]),_:1},8,["loading"]),i($a,{modelValue:ua.value,"onUpdate:modelValue":a[6]||(a[6]=e=>ua.value=e),placeholder:"搜索图标...",style:{width:"200px","margin-left":"10px"},clearable:""},null,8,["modelValue"])])]),v((n(),t("div",be,[(n(!0),t(k,null,h(Ua.value,e=>(n(),t("div",{class:"ui-icon-item",key:e.key,onClick:a=>function(e){navigator.clipboard.writeText(e.url),d.success("已复制图标URL")}(e)},[o("div",he,[o("img",{src:e.url,alt:e.fileName},null,8,_e)]),o("div",we,f(e.fileName),1)],8,ke))),128)),i(Ca,{class:"ui-icon-upload",action:Ye,headers:aa.value,data:{category:"ui-icon"},"show-file-list":!1,"on-success":Da,"before-upload":La,accept:"image/svg+xml,image/png"},{default:c(()=>[o("div",Ne,[i(ca,null,{default:c(()=>[i(m(y))]),_:1}),a[46]||(a[46]=o("span",null,"上传图标",-1))])]),_:1},8,["headers"])])),[[al,Ze.value]])])]),_:1}),i(xa,{label:"Logo/关于",name:"logo"},{default:c(()=>[o("div",Ce,[a[55]||(a[55]=o("div",{class:"section-header"},[o("span",{class:"section-title"},"Logo与关于页面图片"),o("span",{class:"section-tip"},'用于"关于我们"页面和其他需要Logo的地方')],-1)),o("div",Ve,[a[49]||(a[49]=o("h4",null,"应用Logo",-1)),o("div",Ie,[(n(),t(k,null,h(ma,e=>o("div",{class:"logo-item",key:e.key},[o("div",Ue,f(e.label),1),o("div",xe,[i(Ca,{class:"logo-uploader",action:Ye,headers:aa.value,data:{category:"logo",name:e.key},"show-file-list":!1,"on-success":a=>{return l=a,s=e.key,void(200!==l.code&&0!==l.code||!(null==(t=l.data)?void 0:t.url)?d.error(l.message||"上传失败"):(fa[s]=l.data.url+"?t="+Date.now(),d.success("Logo上传成功")));var l,s,t},"before-upload":Aa,accept:"image/*"},{default:c(()=>[fa[e.key]?(n(),_(U,{key:0,src:fa[e.key],fit:"contain",class:"logo-preview"},null,8,["src"])):(n(),t("div",ze,[i(ca,null,{default:c(()=>[i(m(y))]),_:1}),a[47]||(a[47]=o("span",null,"上传",-1))]))]),_:2},1032,["headers","data","on-success"]),fa[e.key]?(n(),_(_a,{key:0,type:"primary",link:"",size:"small",onClick:a=>Ma(fa[e.key])},{default:c(()=>[...a[48]||(a[48]=[p(" 复制URL ",-1)])]),_:1},8,["onClick"])):w("",!0)])])),64))])]),o("div",Ae,[a[54]||(a[54]=o("h4",null,"关于页面图片",-1)),o("div",Le,[i(Ca,{class:"scene-asset-upload",action:Ye,headers:aa.value,data:{category:"about"},"show-file-list":!1,"on-success":Ea,"before-upload":Aa,accept:"image/*"},{default:c(()=>[o("div",Pe,[i(ca,null,{default:c(()=>[i(m(y))]),_:1}),a[50]||(a[50]=o("span",null,"上传图片",-1))])]),_:1},8,["headers"]),o("div",{class:"scene-asset-upload ai-generate-btn",onClick:a[7]||(a[7]=e=>Ta("logo","about"))},[o("div",Be,[i(ca,null,{default:c(()=>[i(m(b))]),_:1}),a[51]||(a[51]=o("span",null,"AI生成",-1))])]),(n(!0),t(k,null,h(ga.value,l=>(n(),t("div",{class:"scene-asset-item",key:l.key},[o("img",{src:l.url,alt:l.fileName},null,8,Ge),o("div",De,[o("span",Re,f(l.fileName),1)]),o("div",Ee,[i(_a,{type:"primary",size:"small",onClick:N(e=>Ma(l.url),["stop"])},{default:c(()=>[...a[52]||(a[52]=[p("复制URL",-1)])]),_:1},8,["onClick"]),i(_a,{type:"danger",size:"small",onClick:N(a=>e.deleteAsset(l.key),["stop"])},{default:c(()=>[...a[53]||(a[53]=[p("删除",-1)])]),_:1},8,["onClick"])])]))),128))])])])]),_:1}),i(xa,{label:"一般素材",name:"general"},{default:c(()=>[o("div",$e,[a[64]||(a[64]=o("div",{class:"section-header"},[o("span",{class:"section-title"},"一般素材"),o("span",{class:"section-tip"},"用于场景步骤调用等通用素材")],-1)),v((n(),t("div",je,[i(Ca,{class:"scene-asset-upload",action:Ye,headers:aa.value,data:{category:"general"},"show-file-list":!1,"on-success":Ra,"before-upload":e.beforeUpload,accept:"image/*"},{default:c(()=>[o("div",Te,[i(ca,null,{default:c(()=>[i(m(y))]),_:1}),a[56]||(a[56]=o("span",null,"上传素材",-1)),a[57]||(a[57]=o("span",{class:"upload-tip"},"PNG/JPG/WebP",-1))])]),_:1},8,["headers","before-upload"]),o("div",{class:"scene-asset-upload ai-generate-btn",onClick:a[8]||(a[8]=e=>Ta("general","ai-generated"))},[o("div",Oe,[i(ca,null,{default:c(()=>[i(m(b))]),_:1}),a[58]||(a[58]=o("span",null,"AI生成",-1)),a[59]||(a[59]=o("span",{class:"upload-tip"},"输入描述生成图片",-1))])]),(n(!0),t(k,null,h(Na.value,e=>(n(),t("div",{class:"scene-asset-item generating-placeholder",key:e.id},[o("div",Se,[i(ca,{class:"is-loading"},{default:c(()=>[i(m(C))]),_:1})]),o("div",Je,[i(ja,{size:"small",type:"warning"},{default:c(()=>[...a[60]||(a[60]=[p("AI生成中",-1)])]),_:1})])]))),128)),(n(!0),t(k,null,h(pa.value,l=>(n(),t("div",{class:"scene-asset-item",key:l.key,onClick:e=>async function(e){Ia.value={...e};try{const a=await x.get(`/assets/metadata/${encodeURIComponent(e.key)}`);0===a.code&&a.data&&(Ia.value={...Ia.value,...a.data,displayName:a.data.name||e.fileName})}catch(a){}Va.value=!0}(l)},[o("img",{src:l.url,alt:l.fileName},null,8,We),"ai-generated"===l.source?(n(),_(ja,{key:0,class:"asset-badge",size:"small",type:"warning"},{default:c(()=>[...a[61]||(a[61]=[p("AI",-1)])]),_:1})):w("",!0),o("div",He,[o("span",Me,f(Xa(l)),1)]),o("div",Xe,[i(_a,{type:"primary",size:"small",onClick:N(e=>Ma(l.url),["stop"])},{default:c(()=>[...a[62]||(a[62]=[p("复制",-1)])]),_:1},8,["onClick"]),i(_a,{type:"danger",size:"small",onClick:N(a=>e.deleteAsset(l.key),["stop"])},{default:c(()=>[...a[63]||(a[63]=[p("删除",-1)])]),_:1},8,["onClick"])])],8,Ke))),128))])),[[al,Ze.value]]),0!==pa.value.length||0!==Na.value.length||Ze.value?w("",!0):(n(),t("div",qe," 暂无一般素材，请上传图片或使用AI生成 "))])]),_:1})]),_:1},8,["modelValue"]),i(el,{modelValue:ya.value,"onUpdate:modelValue":a[14]||(a[14]=e=>ya.value=e),title:"AI生成图片",width:"600px","close-on-click-modal":!1},{footer:c(()=>[o("div",Fe,[i(_a,{onClick:a[13]||(a[13]=e=>ya.value=!1)},{default:c(()=>[...a[65]||(a[65]=[p("取消",-1)])]),_:1}),i(_a,{type:"primary",onClick:Oa,loading:wa.value},{default:c(()=>[p(f(wa.value?"生成中...":"开始生成"),1)]),_:1},8,["loading"])])]),default:c(()=>[i(Za,{"label-width":"80px"},{default:c(()=>[i(Fa,{label:"描述"},{default:c(()=>[i($a,{modelValue:ba.value,"onUpdate:modelValue":a[10]||(a[10]=e=>ba.value=e),type:"textarea",rows:4,placeholder:"请详细描述你想要生成的图片，例如：一匹威风凛凛的银色骏马，鬃毛闪耀着银光，气质高贵优雅，写实风格，4K画质"},null,8,["modelValue"])]),_:1}),i(Fa,{label:"保存名称"},{default:c(()=>[i($a,{modelValue:ka.value,"onUpdate:modelValue":a[11]||(a[11]=e=>ka.value=e),placeholder:"可选，用于标识图片"},null,8,["modelValue"])]),_:1}),i(Fa,{label:"保存目录"},{default:c(()=>[i(Ya,{modelValue:ha.value,"onUpdate:modelValue":a[12]||(a[12]=e=>ha.value=e),style:{width:"100%"}},{default:c(()=>[i(Qa,{label:"AI生成",value:"ai-generated"}),i(Qa,{label:"马匹素材",value:"horses"}),i(Qa,{label:"场景素材",value:"scenes"}),i(Qa,{label:"其他",value:"misc"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(el,{modelValue:Va.value,"onUpdate:modelValue":a[20]||(a[20]=e=>Va.value=e),title:"素材详情",width:"500px"},{footer:c(()=>[i(_a,{onClick:a[19]||(a[19]=e=>Va.value=!1)},{default:c(()=>[...a[67]||(a[67]=[p("关闭",-1)])]),_:1}),i(_a,{type:"primary",onClick:Sa},{default:c(()=>[...a[68]||(a[68]=[p("保存名称",-1)])]),_:1})]),default:c(()=>[Ia.value?(n(),t("div",Qe,[i(U,{src:Ia.value.url,fit:"contain",class:"detail-image"},null,8,["src"]),i(Za,{"label-width":"80px",style:{"margin-top":"15px"}},{default:c(()=>[i(Fa,{label:"名称"},{default:c(()=>[i($a,{modelValue:Ia.value.displayName,"onUpdate:modelValue":a[15]||(a[15]=e=>Ia.value.displayName=e),placeholder:"输入名称"},null,8,["modelValue"])]),_:1}),i(Fa,{label:"文件名"},{default:c(()=>[o("span",null,f(Ia.value.fileName),1)]),_:1}),i(Fa,{label:"来源"},{default:c(()=>[i(ja,{type:"ai-generated"===Ia.value.source?"warning":"info"},{default:c(()=>[p(f("ai-generated"===Ia.value.source?"AI生成":"手动上传"),1)]),_:1},8,["type"])]),_:1}),Ia.value.prompt?(n(),_(Fa,{key:0,label:"Prompt"},{default:c(()=>[i($a,{type:"textarea",rows:3,modelValue:Ia.value.prompt,"onUpdate:modelValue":a[16]||(a[16]=e=>Ia.value.prompt=e),readonly:""},null,8,["modelValue"])]),_:1})):w("",!0),Ia.value.created_at?(n(),_(Fa,{key:1,label:"创建时间"},{default:c(()=>[o("span",null,f(Ia.value.created_at),1)]),_:1})):w("",!0),i(Fa,{label:"URL"},{default:c(()=>[i($a,{modelValue:Ia.value.url,"onUpdate:modelValue":a[18]||(a[18]=e=>Ia.value.url=e),readonly:""},{append:c(()=>[i(_a,{onClick:a[17]||(a[17]=e=>Ma(Ia.value.url))},{default:c(()=>[...a[66]||(a[66]=[p("复制",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})])):w("",!0)]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-28871aaf"]]);export{Ze as default};
