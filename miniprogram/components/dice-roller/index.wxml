<!-- 摇骰子容器组件（重构版） -->
<view class="dice-roller">
  <!-- 标题区域 -->
  <view class="dice-header" wx:if="{{title}}">
    <text class="dice-title">{{title}}</text>
    <text class="dice-subtitle" wx:if="{{subtitle}}">{{subtitle}}</text>
  </view>

  <!-- 骰子/结果区域 -->
  <view class="dice-container">
    <!-- 未抽取或正在摇 - 显示骰子 -->
    <block wx:if="{{!result || isRolling}}">
      <view class="dice-wrapper">
        <dice-cube
          is-rolling="{{isRolling}}"
          current-face="{{currentDiceFace}}"
          disabled="{{confirmed}}"
          bind:tap="onDiceTap"
        />
        <view class="dice-hint" wx:if="{{!isRolling && !confirmed}}">
          <text>点击摇一摇</text>
        </view>
        <view class="dice-hint rolling-hint" wx:elif="{{isRolling}}">
          <text>摇骰子中...</text>
        </view>
      </view>
    </block>

    <!-- 已抽取 - 显示结果 -->
    <block wx:elif="{{result && !isRolling}}">
      <result-card
        draw-type="{{drawType}}"
        result="{{result}}"
        show-rarity="{{showRarity}}"
        show-reroll="{{!confirmed}}"
        show-confirm="{{!confirmed}}"
        free-count="{{freeCount}}"
        cost-per-roll="{{costPerRoll}}"
        bind:reroll="onResultReroll"
        bind:confirm="onResultConfirm"
      />
      <!-- 已确认状态提示 -->
      <view class="confirmed-hint" wx:if="{{confirmed}}">
        <text class="confirmed-icon">✓</text>
        <text>已选择</text>
      </view>
    </block>
  </view>

  <!-- 免费次数提示 -->
  <view class="free-hint" wx:if="{{!confirmed}}">
    <text wx:if="{{freeCount > 0}}">今日免费次数: {{freeCount}}次</text>
    <text wx:else>每次消耗 {{costPerRoll}} 醒币</text>
  </view>

  <!-- 付费确认弹窗 -->
  <view class="confirm-modal" wx:if="{{showPayConfirm}}">
    <view class="confirm-mask" bindtap="onCancelPay"></view>
    <view class="confirm-content">
      <view class="confirm-title">确认消耗醒币</view>
      <view class="confirm-desc">本次摇骰子将消耗 {{costPerRoll}} 醒币</view>
      <view class="confirm-balance">当前余额: {{userPoints}} 醒币</view>
      <view class="confirm-btns">
        <view class="confirm-btn cancel" bindtap="onCancelPay">取消</view>
        <view class="confirm-btn ok" bindtap="onConfirmPay">确认</view>
      </view>
    </view>
  </view>
</view>
