<view class="container">
  <!-- 反馈列表 -->
  <view class="feedback-list-section">
    <view class="list-header">
      <view class="section-title">{{i18n.fb_historyTitle || '我的反馈历史'}}</view>
      <view class="add-btn" bindtap="goToSubmit">
        <text class="plus">+</text>
        <text>{{i18n.fb_addNew || '新建反馈'}}</text>
      </view>
    </view>

    <view class="feedback-list" wx:if="{{feedbackList.length > 0}}">
      <view class="feedback-item" wx:for="{{feedbackList}}" wx:key="feedback_id">
        <view class="feedback-header">
          <text class="feedback-time">{{item.created_at}}</text>
          <view class="header-right">
            <view class="reward-tag" wx:if="{{item.reward_amount > 0}}">
              <image class="reward-icon" src="/images/icon-reward.svg" mode="aspectFit"></image>
              <text class="reward-text">+{{item.reward_amount}}{{i18n.fb_reward || '醒币'}}</text>
            </view>
            <text class="feedback-status {{item.status}}">{{item.status === 'pending' ? (i18n.fb_pending || '处理中') : (i18n.fb_replied || '已回复')}}</text>
            <view class="action-btns" wx:if="{{item.status === 'pending'}}">
              <text class="action-btn edit" bindtap="editFeedback" data-item="{{item}}">{{i18n.fb_edit || '编辑'}}</text>
              <text class="action-btn delete" bindtap="deleteFeedback" data-id="{{item.feedback_id}}">{{i18n.fb_delete || '删除'}}</text>
            </view>
          </view>
        </view>
        <view class="feedback-content">{{item.content}}</view>
        <view class="feedback-images" wx:if="{{item.images && item.images.length > 0}}">
          <image
            wx:for="{{item.images}}"
            wx:for-item="img"
            wx:key="*this"
            src="{{img}}"
            mode="aspectFill"
            bindtap="previewImage"
            data-current="{{img}}"
            data-urls="{{item.images}}"
          ></image>
        </view>
        <view class="feedback-reply" wx:if="{{item.reply_content}}">
          <view class="reply-title">{{i18n.fb_adminReply || '管理员回复：'}}</view>
          <view class="reply-content">{{item.reply_content}}</view>
          <view class="reply-time">{{item.replied_at}}</view>
        </view>
      </view>
    </view>

    <view class="empty-state" wx:else>
      <image class="empty-icon" src="/images/icon-share-flow.svg" mode="aspectFit"></image>
      <view class="empty-text">{{i18n.fb_noRecord || '暂无反馈记录'}}</view>
      <view class="empty-subtext">{{i18n.fb_noRecordTip || '快来创建您的第一条反馈吧！'}}</view>
      <button class="empty-btn" bindtap="goToSubmit">{{i18n.fb_submitNow || '立即反馈'}}</button>
    </view>
  </view>
</view>
